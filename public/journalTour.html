<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Encrypted Journal Tour</title>
  <link rel="stylesheet" href="landingstyles.css" />
  <style>
    /* Reset default padding/margin and ensure full-width */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      box-sizing: border-box;
    }
    /* Center and responsive width for the tour content */
    .tour-container {
      max-width: 800px;
      margin: 0 auto;
      width: 90%;
      padding: 1rem;
      box-sizing: border-box;
    }
    /* Ensure audio player stretches on narrow screens */
    audio {
      width: 70%;
      margin-bottom: 1rem;
    }
    /* Ensure mermaid diagrams scale on mobile */
    .mermaid {
      width: 100%;
      overflow-x: auto;
      margin-bottom: 1rem;
    }
    /* Code blocks scroll and resize on mobile */
    pre {
      font-size: 0.9rem;
      overflow-x: auto;
      white-space: pre-wrap;
      word-break: break-word;
    }
    /* Details summary styling for readability */
    details summary {
      cursor: pointer;
      font-size: 1rem;
      margin-bottom: 0.5rem;
    }
    /* Mobile tweaks */
    @media (max-width: 576px) {
      html {
        font-size: 17px;
      }
        .tour-container {
        width: 100%;
        padding: 0.75rem;
      }
      h1 {
        font-size: 1.6rem;
        margin-bottom: 0.75rem;
      }
      h2 {
        font-size: 1.25rem;
        margin-bottom: 0.5rem;
      }
      ul li {
        font-size: 1rem;
      }
      details summary {
        font-size: 1.05rem;
      }
    }
  </style>
  <script src="https://unpkg.com/mermaid@9/dist/mermaid.min.js"></script>
</head>
<body class="py-5">
  <div class="tour-container">
    <a href="projects.html#journal-card" class="btn btn-sm btn-outline-primary mb-4">‚Üê Back to Portfolio</a>

    <h1 class="mb-4">Encrypted Journal: In‚ÄëDepth Tour</h1>

    <!-- Overview & Dependencies -->
    <section class="mb-5">
      <h2>üîó Overview & Dependencies</h2>
      <p>This application relies on the following Python modules and libraries (as imported at the top of <code>secure_journal.py</code>):</p>
      <ul>
        <li><code>tkinter</code> for GUI components and dialogs <code>import tkinter as tk</code></li>
        <li><code>cryptography</code> primitives for key derivation and encryption (<code>Scrypt</code> and <code>AESGCM</code>)</li>
        <li>Standard library modules: <code>base64</code>, <code>os</code>, <code>sys</code>, <code>gzip</code>, <code>json</code>, <code>datetime</code>, <code>gc</code>, <code>secrets</code>, <code>re</code>, <code>string</code>, <code>contextmanager</code></li>
        <li><code>enchant</code> for spell‚Äëchecking journal entries</li>
        <li>Optional Windows-specific modules (<code>win32security</code> and <code>ntsecuritycon</code>) for setting file permissions</li>
      </ul>
      <p>These imports establish the core functionality: GUI, secure key derivation & encryption, file I/O, spell‚Äëchecking, and optional platform‚Äëspecific enhancements.</p>
      <p class="small text-muted">Import list sourced from <code>secure_journal.py</code> ÓàÄfileciteÓàÇturn1file3ÓàÅ.</p>
    </section>

    <!-- Audio narration -->
    <section class="mb-5">
      <h2>üéôÔ∏è Voice Overview</h2>
      <audio controls preload="metadata" src="assets/audio/journal.m4a">
        <source src="assets/audio/journal-overview.m4a" type="audio/mp4">
        Your browser doesn‚Äôt support the audio element.
      </audio>
    </section>

    <!-- Architectural diagram -->
    <section class="mb-5">
      <h2>üìä Architecture & Data Flow</h2>
      <div class="mermaid">
        flowchart TD
        A["User enters text"] --> B["scrypt() derives key"]
        B --> C["AESGCM.encrypt(nonce, data)"]
        C --> D["Base64 encode and Gzip to journal.json.gz"]
        D --> E["Saved to disk with secure permissions"]
        E --> F["On load: reverse steps"]
      </div>
    </section>

    <!-- Code walkthrough -->
    <section class="mb-5">
      <h2>üíª Code Walkthrough</h2>

      <details class="mb-3">
        <summary><strong>1. Key Derivation (scrypt)</strong></summary>
        <pre><code class="language-python">
# derive a 32-byte key from the passphrase
kdf = Scrypt(
    salt=secrets.token_bytes(16),
    length=32,
    n=2**14, r=8, p=1,
)
key = kdf.derive(password.encode())
        </code></pre>
        <p>This uses Scrypt to turn your passphrase into a strong symmetric key.</p>
      </details>

      <details class="mb-3">
        <summary><strong>2. Encryption (AES-GCM)</strong></summary>
        <pre><code class="language-python">
aesgcm = AESGCM(key)
nonce = secrets.token_bytes(12)
ciphertext = aesgcm.encrypt(nonce, message.encode(), None)
record = {
  "nonce": base64.b64encode(nonce).decode(),
  "entry": base64.b64encode(ciphertext).decode()
}
        </code></pre>
        <p>AES-GCM provides both confidentiality and integrity.</p>
      </details>

      <details class="mb-3">
        <summary><strong>3. Compression & Storage</strong></summary>
        <pre><code class="language-python">
with gzip.open('journal.json.gz', 'wt', encoding='utf-8') as f:
    json.dump(data_list, f, indent=4)
        </code></pre>
        <p>Gzip shrinks the file and JSON ensures structured storage.</p>
      </details>

      <details class="mb-3">
        <summary><strong>4. Loading & Decryption</strong></summary>
        <pre><code class="language-python">
with gzip.open('journal.json.gz', 'rt', encoding='utf-8') as f:
    data_list = json.load(f)
plaintext = aesgcm.decrypt(nonce, ciphertext, None).decode()
        </code></pre>
        <p>Reverses the write steps to retrieve your journal text.</p>
      </details>

      <details>
        <summary><strong>5. GUI Interaction</strong></summary>
        <p>All encryption calls are wrapped in GUI methods with proper password prompts and session timeouts.</p>
      </details>
    </section>
  </div>

  <script>
    if (window.mermaid) mermaid.initialize({ startOnLoad: true });
  </script>
</body>
</html>
